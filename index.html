<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>IPL 2026 Mega Auction - Live Viewer + Admin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" href="https://iplstatic.s3.amazonaws.com/ipl/logo.png" />
<style>
:root {
  --bg: #0f172a;
  --card: #1e293b;
  --text:#e2e8f0;
  --green:#10b981;
  --red:#ef4444;
  --gold:#fbbf24;
  --blue:#3b82f6;
  --purple:#a855f7;
  --border:#334155;
  --accent:#00ff88;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:system-ui,sans-serif;}
body{background:var(--bg);color:var(--text);min-height:100vh;}
.container{max-width:1400px;margin:0 auto;padding:10px;}

header{
  text-align:center;
 padding:20px;
 background:linear-gradient(135deg,#1e40af,#1e293b);
 border-bottom:4px solid var(--gold);
}
h1{font-size:2.8rem;color:var(--gold);text-shadow:0 0 20px #000;}

.top-bar{
  display:flex;justify-content:space-between;align-items:center;margin:15px 0;
}
.status{
  padding:8px 16px;
  border-radius:30px;
  font-weight:bold;
}
.status.live{background:#dcfce7;color:#166534;}
.status.stopped{background:#fee2e2;color:#991b1b;}
.timer{
  background:var(--card);
  padding:8px 16px;
  border-radius:30px;
  border:1px solid var(--border);
}

/* Tabs */
.tabs{
  display:flex;flex-wrap:wrap;gap:10px;margin:20px 0;
}
.tab{
  padding:10px 20px;
  background:#1e293b;
  border-radius:30px;
  cursor:pointer;
  font-weight:600;
}
.tab.active{background:var(--purple);color:white;}

/* Grid */
.grid{
  display:grid;
  grid-template-columns:1fr 380px;
  gap:20px;
  margin-top:20px;
}
@media(max-width:968px){.grid{grid-template-columns:1fr;}}

/* Cards */
.card{
  background:var(--card);
  border-radius:16px;
  padding:20px;
  border:1px solid var(--border);
}
.player-card{
  text-align:center;
  position:relative;
}
.player-photo{
  width:140px;height:140px;
  background:#334155;
  border-radius:50%;
  margin:0 auto 15px;
  display:flex;align-items:center;justify-content:center;
  font-size:48px;font-weight:bold;color:#64748b;
}
.current-bid{
  background:var(--accent);
  color:black;
  padding:15px;
  border-radius:12px;
  font-size:2rem;
  font-weight:bold;
  margin:15px 0;
}
.bid-team{
  display:flex;align-items:center;justify-content:center;gap:10px;margin:10px 0;
}
.team-logo{
  width:50px;height:50px;
  border-radius:50%;
  background:white;
  display:flex;align-items:center;justify-content:center;
  font-weight:bold;
}
.interested{
  display:flex;flex-wrap:wrap;gap:8px;margin-top:15px;
}
.tag{
  background:#334155;
  padding:6px 12px;
  border-radius:20px;
  font-size:0.9rem;
}

/* Team Table */
.team-table{
  width:100%;
  border-collapse:collapse;
  font-size:0.95rem;
}
.team-table th,.team-table td{
  padding:10px;
  border:1px solid var(--border);
  text-align:center;
}
.team-table th{background:#1e293b;}

/* Login */
.login-box{
  max-width:420px;
  margin:30px auto;
  background:var(--card);
  padding:30px;
  border-radius:16px;
  text-align:center;
}
input{
  width:100%;
  padding:14px;
  margin:10px 0;
  border-radius:10px;
  border:none;
  background:#334155;
  color:white;
  font-size:1.1rem;
}
.btn{
  width:100%;
  padding:14px;
  border:none;
  border-radius:10px;
  font-weight:bold;
  cursor:pointer;
  margin-top:10px;
}
.btn-green{background:var(--accent);color:black;}
.btn-red{background:var(--red);color:white;}
.btn-blue{background:var(--blue);color:white;}

/* Admin Panel */
.admin-panel{
  margin-top:30px;
  display:none;
}
.admin-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
  gap:12px;
  margin-top:20px;
}

/* Not Started Banner */
.not-started{
  text-align:center;
  padding:40px;
  background:#7f1d1d;
  color:white;
  border-radius:16px;
  font-size:1.5rem;
  margin:30px 0;
}
.hidden{display:none !important;}
</style>
</head>
<body>

<div class="container">

  <header>
    <h1>IPL 2026 MEGA AUCTION</h1>
    <p style="color:#94a3b8;margin-top:8px;">Live Viewer • Admin Panel • Team Login</p>
  </header>

  <div class="top-bar">
    <div class="status live" id="statusText">LIVE</div>
    <div class="timer">Time Left: <span id="timer">01:00</span></div>
  </div>

  <!-- Auction Not Started Banner -->
  <div class="not-started" id="notStarted">
    AUCTION NOT STARTED<br>
    <small>Waiting for Curator to Start</small>
  </div>

  <!-- Main Auction View (Visible to Everyone) -->
  <div id="auctionView">

    <!-- Current Player -->
    <div class="grid">
      <div>
        <div class="card player-card">
          <h2>CURRENT PLAYER</h2>
          <div class="player-photo" id="playerPhoto">DC</div>
          <h2 id="playerName">Devon Conway</h2>
          <p id="playerInfo">Batsman • New Zealand • Base: ₹2 Cr</p>
          <div class="current-bid" id="currentBid">₹ 2.00 Cr</div>
          <div class="bid-team">
            <div class="team-logo" id="bidTeamLogo">MI</div>
            <div>
              <div style="font-size:0.9rem;opacity:0.8;">Highest Bidder</div>
              <div id="bidTeamName" style="font-weight:bold;">Mumbai Indians</div>
            </div>
          </div>
          <div class="interested" id="interestedTeams"></div>
          <button class="btn btn-green" id="soldBtn" style="margin-top:20px;">SOLD</button>
          <button class="btn btn-red" id="unsoldBtn">UNSOLD</button>
        </div>
      </div>

      <!-- Teams Purse Table -->
      <div>
        <div class="card">
          <h3>TEAM PURSE & SLOTS</h3>
          <table class="team-table" id="teamTable">
            <thead>
              <tr>
                <th>Team</th>
                <th>Purse</th>
                <th>Slots</th>
                <th>OS</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Player List -->
    <div class="card" style="margin-top:30px;">
      <h3>ALL PLAYERS LIST</h3>
      <div style="max-height:500px;overflow-y:auto;">
        <table class="team-table" id="playerTable">
          <thead>
            <tr>
              <th>#</th>
              <th>Player</th>
              <th>Country</th>
              <th>Role</th>
              <th>Base Price</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

  </div>

  <!-- Login Box -->
  <div class="login-box">
    <h2>TEAM / ADMIN LOGIN</h2>
    <input type="text" id="username" placeholder="Username" />
    <input type="password" id="password" placeholder="Password" />
    <button class="btn btn-blue" onclick="login()">LOGIN</button>
    <p style="margin-top:15px;font-size:0.9rem;color:#94a3b8;">
      Admin → qwertyuiop / bluezone0025<br>
      Team logins are in your invite
    </p>
  </div>

  <!-- Admin Panel -->
  <div class="card admin-panel" id="adminPanel">
    <h2 style="color:var(--red);text-align:center;">ADMIN CONTROL PANEL</h2>
    <button class="btn btn-green" onclick="startAuction()">START AUCTION</button>
    <button class="btn btn-red" onclick="stopAuction()">STOP AUCTION</button>
    <button class="btn btn-blue" onclick="nextPlayer()">NEXT PLAYER</button>

    <h3 style="margin-top:20px;">Change Team Password</h3>
    <select id="teamSelect"></select>
    <input type="text" id="newPass" placeholder="New Password" style="width:70%;display:inline-block;" />
    <button class="btn btn-blue" onclick="changeTeamPass()">Update</button>

    <div class="admin-grid">
      <button class="btn" onclick="soldToCurrent()">SOLD to Current Bidder</button>
      <button class="btn" onclick="unsoldCurrent()">Mark UNSOLD</button>
      <button class="btn" onclick="resetBid()">Reset Bid</button>
      <button class="btn" onclick="addBid(0.25)">+0.25 Cr</button>
      <button class="btn" onclick="addBid(0.50)">+0.50 Cr</button>
      <button class="btn" onclick="addBid(1)">+1 Cr</button>
      <button class="btn" onclick="addBid(2)">+2 Cr</button>
    </div>
  </div>

</div>

<script>
// === DATA WILL BE LOADED FROM data.json ===
let players = [];
let teams = [];
let currentPlayerIndex = -1;
let currentBid = 2.00;
let highestBidder = null;
let auctionStarted = false;
let isAdmin = false;
let timerInterval;

// Load data
fetch('data.json')
  .then(r => r.json())
  .then(data => {
    players = data.players;
    teams = data.teams;
    renderTeams();
    renderPlayerList();
    if(players.length > 0) showPlayer(0);
  });

// Render Teams Table
function renderTeams() {
  const tbody = document.querySelector("#teamTable tbody");
  tbody.innerHTML = "";
  teams.forEach(t => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${t.team_name.split(" ")[t.team_name.split(" ").length-1]}</td>
      <td>₹${t.purse_crores} Cr</td>
      <td>${t.overall_slots_left}</td>
      <td>${t.overseas_slots_left}</td>
    `;
    tbody.appendChild(tr);
  });

  // Populate team select for admin
  const select = document.getElementById("teamSelect");
  select.innerHTML = "";
  teams.forEach(t => {
    const opt = document.createElement("option");
    opt.value = t.username;
    opt.textContent = t.team_name;
    select.appendChild(opt);
  });
}

// Render Full Player List
function renderPlayerList() {
  const tbody = document.querySelector("#playerTable tbody");
  tbody.innerHTML = "";
  players.forEach((p,i) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${i+1}</td>
      <td>${p.name}</td>
      <td>${p.country}</td>
      <td>${p.role.toUpperCase()}</td>
      <td>₹${p.base_price_crore} Cr</td>
      <td id="status-${i}">Waiting</td>
    `;
    tbody.appendChild(tr);
  });
}

// Show Current Player
function showPlayer(idx) {
  if(idx < 0 || idx >= players.length) return;
  currentPlayerIndex = idx;
  const p = players[idx];

  document.getElementById("playerName").textContent = p.name;
  document.getElementById("playerInfo").textContent = `${p.role.toUpperCase()} • ${p.country} • Base: ₹${p.base_price_crore} Cr`;
  document.getElementById("playerPhoto").textContent = p.name.split(" ").map(n=>n[0]).join("").toUpperCase();
  document.getElementById("currentBid").textContent = `₹ ${p.base_price_crore.toFixed(2)} Cr`;
  document.getElementById("bidTeamName").textContent = "No bids yet";
  document.getElementById("bidTeamLogo").textContent = "--";
  highestBidder = null;
  currentBid = p.base_price_crore;

  // Reset interested teams
  document.getElementById("interestedTeams").innerHTML = "";

  // Update status in list
  document.querySelectorAll("[id^=status-]").forEach(el => el.textContent = "Waiting");
  document.getElementById(`status-${idx}`).textContent = "LIVE";
  document.getElementById(`status-${idx}`).style.color = "var(--green)";
}

// Timer
function startTimer() {
  let time = 60;
  timerInterval = setInterval(() => {
    time--;
    const m = String(Math.floor(time/60)).padStart(2,"0");
    const s = String(time%60).padStart(2,"0");
    document.getElementById("timer").textContent = `${m}:${s}`;
    if(time <= 0) nextPlayer();
  }, 1000);
}

// Admin Functions
function startAuction() {
  if(!isAdmin) return alert("Admin only");
  auctionStarted = true;
  document.getElementById("notStarted").classList.add("hidden");
  document.getElementById("statusText").textContent = "LIVE";
  document.getElementById("statusText").className = "status live";
  startTimer();
  showPlayer(0);
}

function stopAuction() {
  if(!isAdmin) return;
  auctionStarted = false;
  clearInterval(timerInterval);
  document.getElementById("statusText").textContent = "STOPPED";
  document.getElementById("statusText").className = "status stopped";
}

function nextPlayer() {
  if(!auctionStarted) return;
  if(currentPlayerIndex + 1 < players.length){
    showPlayer(currentPlayerIndex + 1);
    startTimer();
  } else {
    alert("Auction Finished!");
    stopAuction();
  }
}

function addBid(amount) {
  currentBid += amount;
  document.getElementById("currentBid").textContent = `₹ ${currentBid.toFixed(2)} Cr`;
  // In real app you would track which team bid
  const randomTeam = teams[Math.floor(Math.random()*teams.length)];
  highestBidder = randomTeam.team_name;
  document.getElementById("bidTeamName").textContent = highestBidder;
  document.getElementById("bidTeamLogo").textContent = highestBidder.split(" ").pop().length-1];
}

// Login
function login() {
  const u = document.getElementById("username").value.trim();
  const p = document.getElementById("password").value;

  if(u === "qwertyuiop" && p === "bluezone0025"){
    isAdmin = true;
    document.getElementById("adminPanel").style.display = "block";
    alert("Welcome Admin!");
  } else {
    const team = teams.find(t => t.username === u && t.password === p);
    if(team){
      alert(`Welcome ${team.team_name}!`);
      // Team can bid in real version
    } else {
      alert("Invalid credentials");
    }
  }
}

// Change Team Password (Admin only)
function changeTeamPass() {
  if(!isAdmin) return alert("Admin only");
  const username = document.getElementById("teamSelect").value;
  const newP = document.getElementById("newPass").value;
  if(!newP) return alert("Enter new password");
  const team = teams.find(t => t.username === username);
  if(team) team.password = newP;
  alert(`Password for ${team.team_name} updated!`);
  document.getElementById("newPass").value = "";
}

// Initialize
document.getElementById("notStarted").classList.remove("hidden");
document.getElementById("statusText").textContent = "NOT STARTED";
document.getElementById("statusText").className = "status stopped";
</script>
</body>
  </html>
